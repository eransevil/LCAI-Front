{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\n\n// הגדרה של axios לשלוח את ה-cookies אוטומטית עם כל קריאה\naxios.defaults.withCredentials = true;\n\n// פעולה אסינכרונית שתבצע את קריאת ה-API ל-signup\nexport const signup = createAsyncThunk(\"auth/signup\", async (userData, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axios.post(\"/api/auth/signup\", userData, {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    });\n    return response.data.user;\n  } catch (error) {\n    return rejectWithValue(error.response ? error.response.data.message : error.message);\n  }\n});\n\n// פעולה אסינכרונית שתבצע את קריאת ה-API ל-login\nexport const login = createAsyncThunk(\"auth/login\", async (userData, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axios.post(\"/api/auth/login\", userData, {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      withCredentials: true // חשוב כדי לכלול את ה-cookie\n    });\n    return response.data.user; // מחזיר את המידע של המשתמש\n  } catch (error) {\n    return rejectWithValue(error.response ? error.response.data.message : error.message);\n  }\n});\n\n// פעולה אסינכרונית שתבצע את קריאת ה-API ל-logout\nexport const logout = createAsyncThunk(\"auth/logout\", async (_, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axios.post(\"/api/auth/logout\", {}, {\n      withCredentials: true // חשוב כדי לכלול את ה-cookie\n    });\n    return true; // מחזיר אישור ל-logout\n  } catch (error) {\n    return rejectWithValue(error.response ? error.response.data.message : error.message);\n  }\n});\nexport const verifyToken = createAsyncThunk(\"auth/verifyToken\", async (_, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axios.get(\"/api/auth/verifyToken\", {\n      withCredentials: true // שליחה אוטומטית של ה-cookie\n    });\n    return response.data.user; // מחזיר את המידע של המשתמש אם ה-token תקין\n  } catch (error) {\n    return rejectWithValue(error.message); // מחזיר את השגיאה אם קרתה\n  }\n});\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  error: null\n};\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {},\n  extraReducers: builder => {\n    builder\n    // signup\n    .addCase(signup.fulfilled, (state, action) => {\n      state.user = action.payload;\n      state.isAuthenticated = true;\n      state.error = null;\n    }).addCase(signup.rejected, (state, action) => {\n      state.error = action.payload;\n    })\n    // login\n    .addCase(login.fulfilled, (state, action) => {\n      state.user = action.payload;\n      state.isAuthenticated = true;\n      state.error = null;\n    }).addCase(login.rejected, (state, action) => {\n      state.error = action.payload;\n    })\n    // logout\n    .addCase(logout.fulfilled, state => {\n      state.user = null;\n      state.isAuthenticated = false;\n      state.error = null;\n    }).addCase(logout.rejected, (state, action) => {\n      state.error = action.payload;\n    }).addCase(verifyToken.fulfilled, (state, action) => {\n      state.user = action.payload;\n      state.isAuthenticated = true;\n      state.error = null;\n    }).addCase(verifyToken.rejected, (state, action) => {\n      state.error = action.payload;\n    });\n  }\n});\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","defaults","withCredentials","signup","userData","rejectWithValue","response","post","headers","data","user","error","message","login","logout","_","verifyToken","get","initialState","isAuthenticated","authSlice","name","reducers","extraReducers","builder","addCase","fulfilled","state","action","payload","rejected","reducer"],"sources":["/Users/eransevil/Desktop/side projects/lcai/client/src/redux/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\n\n// הגדרה של axios לשלוח את ה-cookies אוטומטית עם כל קריאה\naxios.defaults.withCredentials = true;\n\n// פעולה אסינכרונית שתבצע את קריאת ה-API ל-signup\nexport const signup = createAsyncThunk(\n  \"auth/signup\",\n  async (userData, { rejectWithValue }) => {\n    try {\n      const response = await axios.post(\"/api/auth/signup\", userData, {\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      return response.data.user;\n    } catch (error) {\n      return rejectWithValue(\n        error.response ? error.response.data.message : error.message\n      );\n    }\n  }\n);\n\n// פעולה אסינכרונית שתבצע את קריאת ה-API ל-login\nexport const login = createAsyncThunk(\n  \"auth/login\",\n  async (userData, { rejectWithValue }) => {\n    try {\n      const response = await axios.post(\"/api/auth/login\", userData, {\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        withCredentials: true, // חשוב כדי לכלול את ה-cookie\n      });\n\n      return response.data.user; // מחזיר את המידע של המשתמש\n    } catch (error) {\n      return rejectWithValue(\n        error.response ? error.response.data.message : error.message\n      );\n    }\n  }\n);\n\n// פעולה אסינכרונית שתבצע את קריאת ה-API ל-logout\nexport const logout = createAsyncThunk(\n  \"auth/logout\",\n  async (_, { rejectWithValue }) => {\n    try {\n      const response = await axios.post(\n        \"/api/auth/logout\",\n        {},\n        {\n          withCredentials: true, // חשוב כדי לכלול את ה-cookie\n        }\n      );\n\n      return true; // מחזיר אישור ל-logout\n    } catch (error) {\n      return rejectWithValue(\n        error.response ? error.response.data.message : error.message\n      );\n    }\n  }\n);\n\nexport const verifyToken = createAsyncThunk(\n  \"auth/verifyToken\",\n  async (_, { rejectWithValue }) => {\n    try {\n      const response = await axios.get(\"/api/auth/verifyToken\", {\n        withCredentials: true, // שליחה אוטומטית של ה-cookie\n      });\n\n      return response.data.user; // מחזיר את המידע של המשתמש אם ה-token תקין\n    } catch (error) {\n      return rejectWithValue(error.message); // מחזיר את השגיאה אם קרתה\n    }\n  }\n);\n\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  error: null,\n};\n\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder\n      // signup\n      .addCase(signup.fulfilled, (state, action) => {\n        state.user = action.payload;\n        state.isAuthenticated = true;\n        state.error = null;\n      })\n      .addCase(signup.rejected, (state, action) => {\n        state.error = action.payload;\n      })\n      // login\n      .addCase(login.fulfilled, (state, action) => {\n        state.user = action.payload;\n        state.isAuthenticated = true;\n        state.error = null;\n      })\n      .addCase(login.rejected, (state, action) => {\n        state.error = action.payload;\n      })\n      // logout\n      .addCase(logout.fulfilled, (state) => {\n        state.user = null;\n        state.isAuthenticated = false;\n        state.error = null;\n      })\n      .addCase(logout.rejected, (state, action) => {\n        state.error = action.payload;\n      })\n      .addCase(verifyToken.fulfilled, (state, action) => {\n        state.user = action.payload;\n        state.isAuthenticated = true;\n        state.error = null;\n      })\n      .addCase(verifyToken.rejected, (state, action) => {\n        state.error = action.payload;\n      });\n  },\n});\n\nexport default authSlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}